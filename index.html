<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haroot Al Rasheed | Logistics & AI Automation Portfolio</title>
    <meta name="description" content="The portfolio of Haroot Al Rasheed, a logistics and process optimization specialist with expertise in AI automation, supply chain management, and ERP systems.">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0F172A; color: #94A3B8; }
        .hero-background { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; background-color: #0B1120;
            background-image: linear-gradient(rgba(148,163,184,0.1) 1px, transparent 1px),
                              linear-gradient(to right, rgba(148,163,184,0.1) 1px, transparent 1px);
            background-size: 40px 40px; }
        .glow-on-hover { transition: box-shadow 0.3s ease-in-out; }
        .glow-on-hover:hover { box-shadow: 0 0 15px 5px rgba(56,189,248,0.4); }
        .section-fade-in { opacity: 0; transform: translateY(20px); transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
        .section-fade-in.visible { opacity: 1; transform: translateY(0); }
        #mobile-menu { transition: transform 0.3s ease-in-out; }
        .typing-cursor::after { content: '▋'; animation: blink 1s step-end infinite; color: white; margin-left: 2px; font-family: monospace; }
        @keyframes blink { 50% { opacity: 0; } }
        .timeline-node-pulse { animation: pulse-border 2s cubic-bezier(0.4,0,0.6,1) infinite; }
        @keyframes pulse-border { 0%,100% { box-shadow: 0 0 0 0 rgba(56,189,248,0.7);} 50% { box-shadow: 0 0 0 8px rgba(56,189,248,0);} }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- Header -->
    <header class="bg-slate-900/80 backdrop-blur-sm sticky top-0 z-50 border-b border-slate-800">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-black text-white tracking-wider">
                <a href="#">HAR</a>
            </div>
            <nav class="hidden md:flex items-center space-x-8">
                <a href="#about" class="text-slate-300 hover:text-cyan-400 transition-colors duration-300">About</a>
                <a href="#projects" class="text-slate-300 hover:text-cyan-400 transition-colors duration-300">Projects</a>
                <a href="#skills" class="text-slate-300 hover:text-cyan-400 transition-colors duration-300">Skills</a>
                <a href="#contact" class="text-slate-300 hover:text-cyan-400 transition-colors duration-300">Contact</a>
            </nav>
            <div class="md:hidden">
                 <button id="mobile-menu-button" class="text-white focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="md:hidden bg-slate-900 absolute top-full left-0 w-full transform -translate-x-full">
            <a href="#about" class="block text-center text-slate-300 hover:text-cyan-400 transition-colors duration-300 py-3 border-b border-slate-800">About</a>
            <a href="#projects" class="block text-center text-slate-300 hover:text-cyan-400 transition-colors duration-300 py-3 border-b border-slate-800">Projects</a>
            <a href="#skills" class="block text-center text-slate-300 hover:text-cyan-400 transition-colors duration-300 py-3 border-b border-slate-800">Skills</a>
            <a href="#contact" class="block text-center text-slate-300 hover:text-cyan-400 transition-colors duration-300 py-3">Contact</a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6">
        
        <!-- Hero Section -->
        <section class="min-h-[calc(100vh-80px)] flex flex-col items-center justify-center text-center relative">
            <div class="hero-background"></div>
            <div class="relative z-10">
                <h1 class="text-5xl md:text-7xl font-black text-white mb-4 animate-fade-in-down">
                    Welcome to my Portfolio
                </h1>
                <h2 class="text-2xl md:text-3xl font-bold text-cyan-400 mb-6">Haroot Al Rasheed</h2>
                <p class="max-w-3xl text-lg text-slate-200 mb-8 min-h-[56px]">A motivated logistics professional with hands-on experience in packaging operations and automotive assembly, specializing in optimizing supply chain workflows and implementing AI-driven process automation.</p>
                <div class="flex flex-wrap justify-center gap-4 items-center text-slate-400 text-sm mb-10">
                    <span class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg> haroot.al.rasheed@volvocars.com</span>
                    <span class="hidden md:inline">|</span>
                    <span class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg> +46 79 337 96 23</span>
                     <span class="hidden md:inline">|</span>
                    <span class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg> Göteborg, Sweden</span>
                </div>
                <div class="mt-12 text-center animate-bounce">
                    <span class="text-sm text-slate-400">Scroll to See My Work</span>
                    <svg class="w-6 h-6 mx-auto mt-1 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </div>
            </div>
        </section>

        <!-- AI Sandbox -->
        <section id="sandbox" class="py-20 section-fade-in">
            <div class="max-w-3xl mx-auto text-center">
                <h2 class="text-3xl font-bold text-white mb-4 flex items-center justify-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-cyan-400"><path d="M12 8V4H8"/><rect x="4" y="4" width="16" height="16" rx="2"/><path d="M20 12h-4"/><path d="m12 12-4 4"/><path d="M12 16v-4"/></svg>
                    AI Logistics
                </h2>
                 <p class="max-w-2xl mx-auto text-center mb-8">
                   I'm Haroot's professional AI assistant. Challenge me with an automation problem for your enterprise to see how my skills can bring value to your team.
                </p>
                <div class="bg-slate-800/50 border border-slate-700 rounded-lg p-8">
                    <div id="ai-response-container" class="text-left text-white mb-6 min-h-[80px]"></div>

                    <div class="relative mb-6">
                        <input type="text" id="ai-prompt" class="w-full bg-slate-700 border border-slate-600 text-white rounded-full py-3 px-6 pr-28 focus:outline-none focus:ring-2 focus:ring-cyan-500" placeholder="Ask an automation question...">
                        <button id="ai-submit" class="absolute right-2 top-1/2 -translate-y-1/2 bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-6 rounded-full transition-transform duration-300 transform hover:scale-105">
                            Get Insight
                        </button>
                    </div>

                    <div id="suggested-follow-ups" class="text-left"></div>

                    <div id="audio-controls" class="mt-4 flex items-center justify-start hidden">
                         <button id="read-aloud-btn" class="flex items-center gap-2 text-cyan-400 hover:text-cyan-300 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                            <span id="read-aloud-text">Read Aloud</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Contact Section -->
        <section id="contact" class="py-20 section-fade-in">
            <h2 class="text-3xl font-bold text-white text-center mb-12 flex items-center justify-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-cyan-400"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                Get In Touch
            </h2>
            <div class="max-w-4xl mx-auto grid md:grid-cols-3 gap-8 text-center">
                <a href="mailto:haroot.al.rasheed@volvocars.com" class="bg-slate-800/50 border border-slate-700 p-8 rounded-lg hover:border-cyan-500 hover:-translate-y-2 transition-all duration-300 glow-on-hover group">
                    <div class="flex justify-center mb-4">
                         <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-cyan-400 group-hover:scale-110 transition-transform"><rect x="2" y="4" width="20" height="16" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg>
                    </div>
                    <h3 class="text-xl font-semibold text-white mb-2">Email</h3>
                    <p class="text-slate-400 group-hover:text-cyan-300 transition-colors break-words">haroot.al.rasheed@volvocars.com</p>
                </a>
                <a href="tel:+46793379623" class="bg-slate-800/50 border border-slate-700 p-8 rounded-lg hover:border-cyan-500 hover:-translate-y-2 transition-all duration-300 glow-on-hover group">
                    <div class="flex justify-center mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-cyan-400 group-hover:scale-110 transition-transform"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                    </div>
                    <h3 class="text-xl font-semibold text-white mb-2">Phone</h3>
                    <p class="text-slate-400 group-hover:text-cyan-300 transition-colors">+46 79 337 96 23</p>
                </a>
                <a href="https://www.google.com/maps/search/?api=1&query=L%C3%A5ngstr%C3%BMsgatan+300,+418+70+G%C3%B6teborg" target="_blank" rel="noopener noreferrer" class="bg-slate-800/50 border border-slate-700 p-8 rounded-lg hover:border-cyan-500 hover:-translate-y-2 transition-all duration-300 glow-on-hover group">
                    <div class="flex justify-center mb-4">
                         <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-cyan-400 group-hover:scale-110 transition-transform"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                    </div>
                    <h3 class="text-xl font-semibold text-white mb-2">Location</h3>
                    <p class="text-slate-400 group-hover:text-cyan-300 transition-colors">Göteborg, Sweden</p>
                </a>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="py-20 section-fade-in">
             <h2 class="text-3xl font-bold text-white text-center mb-12 flex items-center justify-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-cyan-400"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                About Me
            </h2>
            <div class="flex flex-col md:flex-row items-center gap-10">
                <div class="md:w-1/3 text-center">
                    <div class="relative inline-block">
                        <img src="images/Haroot.png" alt="Haroot Al Rasheed" class="rounded-full w-64 h-64 mx-auto object-cover border-4 border-slate-700">
                         <div class="absolute inset-0 rounded-full border-4 border-cyan-500/50 animate-pulse"></div>
                    </div>
                </div>
                <div class="md:w-2/3 text-center md:text-left">
                    <p class="text-lg mb-4">
                        Hello! I'm Haroot, a dedicated and motivated logistics professional currently enhancing my knowledge with a degree in International Logistics and Green Management. With a solid background in the automotive industry at Volvo Cars and Volvo Trucks, I've developed a strong skill set in material handling and high-paced assembly environments.
                    </p>
                    <p class="text-lg mb-4">
                        My experience in packaging operations for the EMEA region at Volvo has allowed me to assist in optimizing packaging solutions to improve both efficiency and sustainability across global supply chains. I am passionate about finding innovative solutions to complex logistical challenges.
                    </p>
                    <p class="text-lg">
                        I am skilled in process efficiency, supply chain optimization, and leveraging technology to drive improvements. I'm always eager to learn and apply new skills to create impactful results.
                    </p>
                </div>
            </div>
        </section>

        <!-- Projects Section -->
        <section id="projects" class="py-20 section-fade-in">
            <h2 class="text-3xl font-bold text-white text-center mb-16">
                Project Experience & Workflow Design
            </h2>
            <div class="relative max-w-4xl mx-auto px-4">
                <div class="space-y-16">
                    <div class="relative flex items-start gap-6">
                        <div class="flex-shrink-0 w-12 h-12 flex items-center justify-center">
                            <div class="w-6 h-6 bg-slate-800 border-2 border-cyan-500 rounded-full timeline-node-pulse"></div>
                        </div>
                        <div class="flex-grow pt-1">
                            <h3 class="text-2xl font-bold text-cyan-400 mb-2">PO Virtual AI Agent</h3>
                            <p class="text-slate-300">Designed a comprehensive workflow for a Purchase Order AI agent to manage inbound and outbound logistics operations, from carrier management to packaging and shipment status.</p>
                        </div>
                    </div>
                    <div class="relative flex items-start gap-6">
                        <div class="flex-shrink-0 w-12 h-12 flex items-center justify-center">
                            <div class="w-6 h-6 bg-slate-800 border-2 border-cyan-500 rounded-full timeline-node-pulse" style="animation-delay: 0.2s;"></div>
                        </div>
                        <div class="flex-grow pt-1">
                            <h3 class="text-2xl font-bold text-cyan-400 mb-2">AI Return Workflow Automation</h3>
                            <p class="text-slate-300">Mapped an end-to-end automated process for handling product returns via an AI agent, covering everything from initial request and data validation to final resolution and system updates.</p>
                        </div>
                    </div>
                    <div class="relative flex items-start gap-6">
                        <div class="flex-shrink-0 w-12 h-12 flex items-center justify-center">
                            <div class="w-6 h-6 bg-slate-800 border-2 border-cyan-500 rounded-full timeline-node-pulse" style="animation-delay: 0.4s;"></div>
                        </div>
                        <div class="flex-grow pt-1">
                            <h3 class="text-2xl font-bold text-cyan-400 mb-2">AI Agent User Interaction Flow</h3>
                            <p class="text-slate-300">Developed a user-centric flowchart detailing the interaction logic for an AI agent, ensuring a seamless and intuitive experience for users when resolving logistics inquiries.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Skills Section -->
        <section id="skills" class="py-20 section-fade-in">
            <h2 class="text-3xl font-bold text-white text-center mb-12 flex items-center justify-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-cyan-400"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>
                Technical Skills & Competencies
            </h2>
            <div class="max-w-4xl mx-auto flex flex-wrap justify-center gap-4">
                <span class="bg-slate-700 text-slate-300 text-lg font-medium px-5 py-2 rounded-full">Low-code Microsoft</span>
                <span class="bg-slate-700 text-slate-300 text-lg font-medium px-5 py-2 rounded-full">Azure AI Foundry</span>
                <span class="bg-slate-700 text-slate-300 text-lg font-medium px-5 py-2 rounded-full">Miro Mapping</span>
                <span class="bg-slate-700 text-slate-300 text-lg font-medium px-5 py-2 rounded-full">SQL Basics</span>
                <span class="bg-slate-700 text-slate-300 text-lg font-medium px-5 py-2 rounded-full">FMEA Analysis</span>
                <span class="bg-slate-700 text-slate-300 text-lg font-medium px-5 py-2 rounded-full">Alpega CMS</span>
                <span class="bg-slate-700 text-slate-300 text-lg font-medium px-5 py-2 rounded-full">INET TMS</span>
                <span class="bg-slate-700 text-slate-300 text-lg font-medium px-5 py-2 rounded-full">Power BI</span>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 border-t border-slate-800">
        <div class="container mx-auto px-6 py-6 text-center text-slate-500">
            <p>&copy; 2025 Haroot Al Rasheed. All rights reserved.</p>
        </div>
    </footer>
    
    <script>
        // --- Typewriter Effect for AI ---
        const typewriterEffect = (element, text, callback) => {
            let i = 0;
            element.innerHTML = '';
            element.classList.add('typing-cursor'); 
            const typing = () => {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(typing, 25);
                } else {
                    element.classList.remove('typing-cursor');
                    if (callback) callback();
                }
            };
            typing();
        };

        document.addEventListener('DOMContentLoaded', () => {
            // --- Section Fade-in on Scroll ---
            const sections = document.querySelectorAll('.section-fade-in');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('visible'); });
            }, { threshold: 0.1 });
            sections.forEach(section => observer.observe(section));

            // --- AI Sandbox Logic ---
            const aiPrompt = document.getElementById('ai-prompt');
            const aiSubmit = document.getElementById('ai-submit');
            const aiResponseContainer = document.getElementById('ai-response-container');
            const suggestedFollowUpsContainer = document.getElementById('suggested-follow-ups');
            const audioControls = document.getElementById('audio-controls');
            const readAloudBtn = document.getElementById('read-aloud-btn');
            const readAloudText = document.getElementById('read-aloud-text');

            const knowledgeBase = `
                About Haroot Al Rasheed:
                - A dedicated and motivated logistics professional with a degree in International Logistics and Green Management.
                - Has a solid background in the automotive industry at Volvo Cars and Volvo Trucks.
                - Skilled in material handling, high-paced assembly environments, process efficiency, and supply chain optimization.
                - Experience in packaging operations for the EMEA region at Volvo, optimizing solutions for efficiency and sustainability.
                - Passionate about finding innovative solutions to complex logistical challenges.
                - Proficient in leveraging technology, including AI, to drive improvements.
                - Can integrate and work with any type of ERP system to automate and improve workflows.

                Projects:
                - PO Virtual AI Agent: Designed a workflow for a Purchase Order AI agent for inbound/outbound logistics.
                - AI Return Workflow Automation: Mapped an end-to-end automated process for product returns using an AI agent.
                - AI Agent User Interaction Flow: Developed a user-centric flowchart for AI agent interaction logic.

                Skills:
                - Low-code Microsoft, Azure AI Foundry, Miro Mapping, SQL Basics, FMEA Analysis, Alpega CMS, INET TMS, Power BI.

                Contact Information:
                - Email: haroot.al.rasheed@volvocars.com
                - Phone: +46 79 337 96 23
                - Location: Göteborg, Sweden
            `;

            const systemPrompt = `
                You are Haroot Al Rasheed's professional AI assistant. Your personality is professional, knowledgeable, and helpful.
                Your primary goal is to answer questions from potential recruiters or clients based *only* on the provided knowledge base.
                When asked a question, you will use the information in the knowledge base to formulate a concise and relevant answer from Haroot's perspective (use "I" and "my").
                Do not make up information. If the answer is not in the knowledge base, politely state that you can't answer that specific question and suggest they ask about skills, experience, or projects, or guide them to the contact information for more detailed discussions.
                For example, if asked about real-time availability, respond naturally like: "I can't provide my real-time schedule, but I'm actively seeking new opportunities. I recommend reaching out via my email or phone to discuss availability."
            `;
            
            const curatedFollowUps = [
                "What is your experience with ERP systems?",
                "How can you help automate our supply chain?",
                "Tell me more about your AI agent projects?",
                "How can I contact you?"
            ];

            let currentAudio = null;
            
            const callGeminiAPI = async (userPrompt) => {
                const fullPrompt = `
                    Here is my professional background and skills (knowledge base):
                    ---
                    ${knowledgeBase}
                    ---
                    Based *only* on the information above, answer the following question from my perspective: "${userPrompt}"
                `;
               
                const apiUrl = '/.netlify/functions/gemini-proxy';

                const payload = {
                    contents: [{ role: "user", parts: [{ text: fullPrompt }] }],
                    systemInstruction: { parts: [{ text: systemPrompt }] }
                };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        const errText = await response.text().catch(()=>'');
                        throw new Error(`API ${response.status} ${response.statusText} ${errText}`);
                    }
                    const result = await response.json();
                    return result.candidates?.[0]?.content?.parts?.[0]?.text || "I'm sorry, I couldn't generate a response at this time.";

                } catch (error) {
                    console.error("Error calling Gemini API:", error);
                    const errorHtml = `
                        <div class="bg-red-900/50 border border-red-500/50 rounded-lg p-4 flex items-start gap-3 text-left">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-red-400 flex-shrink-0 mt-0.5"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                            <div>
                                <h4 class="font-bold text-red-300">Connection Error</h4>
                                <p class="text-red-400 text-sm">Could not connect to the AI service. Details: ${String(error).slice(0,300)}</p>
                            </div>
                        </div>
                    `;
                    aiResponseContainer.innerHTML = errorHtml;
                    return null;
                }
            };

            const callGeminiTTS = async (textToSpeak) => {
                const apiUrl = '/.netlify/functions/gemini-proxy-tts';

                const payload = {
                    input: { text: textToSpeak },
                    voice: { languageCode: "en-US", name: "en-US-Standard-C" },
                    audioConfig: { audioEncoding: "MP3" }
                };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) throw new Error('TTS API error');
                    const result = await response.json();
                    return result.audioContent;
                } catch (error) {
                    console.error("Error calling TTS API:", error);
                    return null;
                }
            };

            const displayFollowUps = () => {
                suggestedFollowUpsContainer.innerHTML = `<h4 class="text-sm font-bold text-slate-400 mb-2">Suggested Follow-ups:</h4>`;
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'flex flex-wrap gap-2';
                curatedFollowUps.forEach(q => {
                    const button = document.createElement('button');
                    button.textContent = q;
                    button.className = 'bg-slate-700 hover:bg-slate-600 text-slate-300 text-sm py-1 px-3 rounded-full transition-colors';
                    button.onclick = () => { aiPrompt.value = q; handleSubmission(); };
                    buttonContainer.appendChild(button);
                });
                suggestedFollowUpsContainer.appendChild(buttonContainer);
            };
            
            const handleSubmission = async () => {
                const prompt = aiPrompt.value.trim();
                if (!prompt) return;

                aiSubmit.disabled = true;
                aiSubmit.textContent = 'Thinking...';
                
                let responseP = document.createElement('p');
                aiResponseContainer.innerHTML = '';
                aiResponseContainer.appendChild(responseP);
                responseP.classList.add('text-white', 'animate-pulse');
                responseP.textContent = 'Generating response...';

                if(currentAudio) currentAudio.pause();
                audioControls.classList.add('hidden');
                
                const responseText = await callGeminiAPI(prompt);
                
                responseP.classList.remove('animate-pulse');

                if(responseText){
                    typewriterEffect(responseP, responseText, () => { audioControls.classList.remove('hidden'); });
                }
                
                aiSubmit.disabled = false;
                aiSubmit.textContent = 'Get Insight';
                aiPrompt.value = '';
                displayFollowUps();
            };

            if(aiSubmit) aiSubmit.addEventListener('click', handleSubmission);
            if(aiPrompt){
                aiPrompt.addEventListener('keydown', (e) => { if (e.key === 'Enter') handleSubmission(); });
            }

            if(readAloudBtn){
                readAloudBtn.addEventListener('click', async () => {
                    const responseP = aiResponseContainer.querySelector('p');
                    if (!responseP || !responseP.textContent) return;
                    const text = responseP.textContent;

                    readAloudText.textContent = "Loading Audio...";
                    readAloudBtn.disabled = true;

                    const audioContent = await callGeminiTTS(text);
                    
                    readAloudText.textContent = "Read Aloud";
                    readAloudBtn.disabled = false;

                    if(audioContent){
                        const audioBlob = new Blob([Uint8Array.from(atob(audioContent), c => c.charCodeAt(0))], { type: 'audio/mpeg' });
                        const audioUrl = URL.createObjectURL(audioBlob);
                        currentAudio = new Audio(audioUrl);
                        currentAudio.play();
                        currentAudio.onended = () => { readAloudText.textContent = "Read Aloud"; };
                        currentAudio.onplaying = () => { readAloudText.textContent = "Playing..."; };
                    } else {
                         const errorP = document.createElement('p');
                         errorP.className = "text-red-400 text-sm mt-2";
                         errorP.textContent = "Could not load audio.";
                         aiResponseContainer.appendChild(errorP);
                    }
                });
            }

            // --- Smooth Scroll & Mobile Menu ---
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            const setupSmoothScroll = (selector) => {
                document.querySelectorAll(selector).forEach(anchor => {
                    anchor.addEventListener('click', function (e) {
                        e.preventDefault();
                        if(mobileMenu) mobileMenu.classList.add('-translate-x-full');
                        const targetId = this.getAttribute('href');
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) targetElement.scrollIntoView({ behavior: 'smooth' });
                    });
                });
            };
            
            if(mobileMenuButton){
                mobileMenuButton.addEventListener('click', () => {
                    if(mobileMenu) mobileMenu.classList.toggle('-translate-x-full');
                });
            }

            setupSmoothScroll('header a[href^="#"]');
            setupSmoothScroll('#mobile-menu a[href^="#"]');

            displayFollowUps();
        });

    </script>

</body>
</html>
